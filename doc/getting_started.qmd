---
title: "Getting started"
---


## Presentation

::: {.callout-note}
This is a quick introduction to the features and usage of the package. See the [usage](usage.qmd) page for more detailed informations.
:::


### What is it?

`pylifemap` is a Python package that allows to visualize your own taxonomy data on the interactive tree of life provided by [Lifemap](https://lifemap.cnrs.fr).

It allows to create this type of interactive visualization:

```{python}
#| warning: false

import polars as pl
from pylifemap import Lifemap

# Load iucn dataset
iucn = pl.read_parquet(
    "https://raw.githubusercontent.com/Lifemap-ToL/pylifemap/main/data/iucn.parquet"
)

Lifemap(iucn).layer_points(radius=5, opacity=0.8).show()
```


### How do I use it?

`pylifemap` visualizations are [jupyter widgets](https://ipywidgets.readthedocs.io/en/latest/) and are better created inside a notebook environment, such as [Jupyter](https://jupyter.org), [marimo](https://marimo.io) or [Quarto](https://quarto.org). These environments allow to create documents with text, code and code output, including plots and interactive widgets. They allow to create and develop computations and visualizations interactively.

It is also possible to generate `pylifemap` visualizations from a Python script. In this case the interactive widget will be directly opened in your Web browser.


## Installation

You can install `pylifemap` like any other Python package. The recommended way is via `pip` or [uv](https://docs.astral.sh/uv/):

::: {.panel-tabset}

## pip

```sh
# Install pylifemap, preferably in a virtual environment
pip install pylifemap
```

## uv

```sh
# Add pylifemap to a python project
uv add pylifemap
```
:::

To have an overview of the package without installing anything, you can also open our introduction notebook in Google Colab: [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/Lifemap-ToL/pylifemap/blob/master/notebooks/introduction.ipynb)





## Creating a visualization

To create a Lifemap data visualization, you must follow these steps:

1. Import `Lifemap`
2. Prepare and load your data
3. Initialize a [Lifemap](`~pylifemap.Lifemap`) object
4. Add visualization layers

### 1. Import Lifemap

To be able to use `pylifemap` in a script or notebook you have to import `Lifemap` from the package with the following line:

```{python}
from pylifemap import Lifemap
```

### 2. Prepare your data


The data you want to visualize on the Lifemap tree of life must be in a [pandas](https://pandas.pydata.org) or [polars](https://pola.rs) DataFrame. They must contain observations (species) as rows, and variables as columns, and one column must contain the NCBI taxonomy identifier of the species.

In the following we will use an example dataset generated from [The IUCN Red List of Threatened Species](https://www.gbif.org/dataset/19491596-35ae-4a91-9a98-85cf505f1bd3). It is a parquet file with the Red List category (in 2022) of more than 84000 species.

We can import it as a polars or pandas DataFrame with the following code:

::: {.panel-tabset}

## Polars

```{python}
import polars as pl

iucn = pl.read_parquet(
    "https://raw.githubusercontent.com/Lifemap-ToL/pylifemap/main/data/iucn.parquet"
)
```

## Pandas

```{python}
#| eval: false
import pandas as pd

iucn = pd.read_parquet(
    "https://raw.githubusercontent.com/Lifemap-ToL/pylifemap/main/data/iucn.parquet"
)
```

:::

The resulting table only has two columns: `taxid`, which contains the species identifiers, and `status`, with the Red List category of each species.

```{python}
iucn
```

For some visualizations you will have to aggregate a count of species or the values of a numerical or categorical variable along the tree branches. For this you can use one of the provided [aggregation functions](reference/index.html#aggregation-functions).




### 3. Initialize a `Lifemap` object

The next step is to create a new [Lifemap](`~pylifemap.Lifemap`) object. To do this we have to pass it our DataFrame, as well as the name of the column with our taxonomy identifiers^[if your column is named "taxid" you can omit the `taxid_col` argument as it is its default value.]. We will also add `.show()`, which is needed to display the visualization.

```{python}
Lifemap(iucn, taxid_col="taxid").show()
```

For the moment this only displays the Lifemap base map.

## 4. Add visualization layers

After initializing our `Lifemap` object, we must add visualization layers to create graphical representations of our data. For example, we can add a points layer which will add a colored point over each species in our dataset. To do that, we can add a call to `layer_points()`:

```{python}
Lifemap(iucn, taxid_col="taxid").layer_points().show()
```

Some layers allow to represent the values of one of our dataset columns. For example, we can color our points depending on the values in the `status` column of `iucn`:

```{python}
Lifemap(iucn, taxid_col="taxid").layer_points(fill="status").show()
```


::: {.callout-note}
There are many options to customize the base map or the layers, see the [usage](usage.qmd) page for more informations.
:::


## Exporting a visualization

Once you are satisfied with a visualization, there are several ways to export it:

- at any time, you can use the "Export PNG" button on the widget to export the current view as a PNG image. You can use the "Fullscreen" button first to generate bigger images if needed
- you can use `.save("file.html")` instead of `.show()` to save the widget to an HTML file
- if in a Jupyter notebook, you can save it to HTML, which will include the widgets in the output
- you can also use [Quarto](https://quarto.org) to generate an HTML document embedding pylifemap widgets, or to convert a Jupyter notebook to an HTML file
